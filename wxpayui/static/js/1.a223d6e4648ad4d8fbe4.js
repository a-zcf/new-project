webpackJsonp([1],{VX41:function(n,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("bOdI"),e=a.n(s),i=a("P9l9"),o=(a("fxnj"),{name:"payment",data:function(){return e()({supplierData:{},smokeData:{},active:1,show:!1,codeStr:"",strip:"",appId:0,timeStamp:"",nonceStr:"",package:"",signType:"",paySign:"",amount:0,url:"",title:"",img:"",list:[],goodLists:[],mescroll:null,mescrollDown:{use:!1},mescrollUp:{callback:this.upCallback,noMoreSize:1,page:{num:0,size:10,time:null},empty:{warpId:"mescroll",tip:"暂无相关数据"},htmlNodata:'<p class="upwarp-nodata">-- 已加载完 --</p>',htmlLoading:'<p class="mescroll-bottom"><span class="upwarp-progress mescroll-rotate"></span><span class="upwarp-tip">加载中...</span></p>'},area:"",activityList:[]},"show",!1)},mounted:function(){var n=this,t=this.$qs.parse(location.search.substring(1));""===this.$store.state.token&&this.$store.commit(types.LOGIN,t.token),this.codeStr=t.c,this.strip=t.t,this.area=t.area,this.getWxPay(),this.$getRequest(i.commodityClassList).then(function(t){0===t.data.code&&(n.list=t.data.data)})},methods:{changeList:function(n){this.active=n,this.mescroll.resetUpScroll()},getWxPay:function(){var n=this;""!=this.codeStr?this.$postRequest(i.WxPay,{codeStr:this.codeStr}).then(function(t){if(0===t.data.code){n.supplierData=t.data.data.supplierData,n.smokeData=t.data.data.smokeData;var a=t.data.data.activity,s=a.url,e=a.title,i=a.img,o=a.shopNo;n.url=s,n.title=e,n.img=i,localStorage.setItem("shopNo",o);var r=t.data.data.payConfig,c=r.appId,p=r.timeStamp,l=r.nonceStr,u=r.signType,d=r.paySign,m=r.packageValue,h=r.orderId,g=r.amount;n.appId=c,n.timeStamp=p,n.nonceStr=l,n.package=m,n.signType=u,n.paySign=d,n.amount=g,n.brandActivityinfo(h)}else 1006===t.data.code||1005===t.data.code&&"1"==t.data.data.ismy?n.$router.push({path:"/paid",query:{codeStr:n.codeStr,strip:n.strip}}):1005===t.data.code&&"0"==t.data.data.ismy?n.$router.push({path:"/nonpayment",query:{codeStr:n.codeStr,strip:n.strip}}):1002===t.data.code?n.$router.push({path:"/detailimg",query:{detailImg:t.data.data.smokeData.detailImg}}):n.$toast.fail(t.data.msg)}):this.$toast.fail("无效的二维码，请重新扫码！")},mescrollInit:function(n){this.mescroll=n},upCallback:function(n,t){var a=this;setTimeout(function(){var s=localStorage.getItem("shopNo");a.$getRequest(i.goodsList+s+"/"+a.active,{current:n.num,size:n.size}).then(function(s){if(0===s.data.code){var e=s.data.data.records;1===n.num&&(a.goodLists=[]),a.goodLists=a.goodLists.concat(e),a.$nextTick(function(){t.endSuccess(e.length),"3"===a.active&&t.removeEmpty()})}else t.endErr()})},500)},onBridgeReady:function(){var n=this;WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:n.appId,timeStamp:n.timeStamp,nonceStr:n.nonceStr,package:n.package,signType:n.signType,paySign:n.paySign},function(t){"get_brand_wcpay_request:ok"==t.err_msg?n.$router.push({path:"/paymentsuccess"}):"get_brand_wcpay_request:fail"==t.err_msg&&n.$toast.fail("支付失败！")})},brandActivityinfo:function(n){var t=this;this.$postRequest(i.getBrandActivityinfo,{orderId:n,area:this.area}).then(function(n){0===n.data.code&&(t.activityList=n.data.data.activityList)})},clickDjtz:function(){window.location.href=this.url},payDetails:function(){this.show=!1},showPopup:function(){this.show=!0},clickShowPopup:function(n){this.show=n}}}),r=function(){var n=this,t=n.$createElement,a=n._self._c||t;return a("div",{staticClass:"user-payment"},[a("mescroll-vue",{ref:"mescroll",attrs:{down:n.mescrollDown,up:n.mescrollUp,id:"mescroll"},on:{init:n.mescrollInit}},[1==n.strip?a("whole-package",{attrs:{supplierData:n.supplierData,smokeData:n.smokeData}},[a("div",{staticClass:"yin-zhang01",style:""==n.smokeData.imgUrl||null==n.smokeData.imgUrl?"display: none;":"",attrs:{slot:"yinzhang"},slot:"yinzhang"},[n._v("\n        正品\n      ")])]):n._e(),n._v(" "),0==n.strip?a("strip",{attrs:{supplierData:n.supplierData,smokeData:n.smokeData}},[a("div",{staticClass:"yin-zhang02",style:""==n.smokeData.imgUrl||null==n.smokeData.imgUrl?"display: none;":"",attrs:{slot:"yinzhang"},slot:"yinzhang"},[n._v("\n        正品\n      ")])]):n._e(),n._v(" "),a("boss-infor",{attrs:{supplierData:n.supplierData}}),n._v(" "),0!==n.activityList.length?a("van-swipe",{staticClass:"my-swipe",attrs:{autoplay:5e3,"indicator-color":"#4486ff"}},n._l(n.activityList,function(t,s){return a("van-swipe-item",{key:s},[a("p",{staticClass:"swipe-title"},[n._v(n._s(t.title))]),n._v(" "),a("img",{staticClass:"guangao-img",attrs:{src:t.img},on:{click:function(t){return n.showPopup()}}})])}),1):n._e(),n._v(" "),a("tab-list",{attrs:{list:n.list,goodLists:n.goodLists},on:{changeList:n.changeList}})],1),n._v(" "),a("activity-list",{attrs:{activityList:n.activityList,show:n.show},on:{clickShowPopup:function(t){return n.clickShowPopup(t)}}}),n._v(" "),a("div",{staticClass:"footer"},[a("span",{staticClass:"price"},[a("b",[n._v("零售价￥：")]),n._v(n._s(n.amount))]),n._v(" "),a("span",{staticClass:"pay-but",on:{click:n.onBridgeReady}},[n._v("立即支付")])])],1)};r._withStripped=!0;var c={render:r,staticRenderFns:[]},p=c;var l=!1;var u=a("VU/8")(o,p,!1,function(n){l||a("bmRh")},null,null);u.options.__file="src/views/payment/payment.vue";t.default=u.exports},bmRh:function(n,t,a){var s=a("dWzf");"string"==typeof s&&(s=[[n.i,s,""]]),s.locals&&(n.exports=s.locals);a("rjj0")("44779b0c",s,!1,{})},dWzf:function(n,t,a){(n.exports=a("FZ+f")(!0)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","",{version:3,sources:[],names:[],mappings:"",file:"payment.vue",sourceRoot:""}])}});
//# sourceMappingURL=1.a223d6e4648ad4d8fbe4.js.map